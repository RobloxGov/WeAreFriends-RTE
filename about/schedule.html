<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8" />
    <title>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏≠‡∏ö</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
      
      * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
          font-family: 'Kanit', sans-serif;
      }
      select, table {
        margin-top: 20px;
        font-size: 16px;
      }
      table {
        border-collapse: collapse;
        width: 100%;
      }
      th, td {
        border: 1px solid #ccc;
        padding: 8px;
        text-align: left;
      }
      th {
        background-color: #f2f2f2;
      }
    </style>
</head>
<body>
    <h2>üìÖ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏≠‡∏ö 1/2568</h2>
  
    <label for="typeSelect">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</label>
    <select id="typeSelect">
      <option value="‡πÄ‡∏£‡∏µ‡∏¢‡∏ô 1/2568">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>
      <option value="‡∏™‡∏≠‡∏ö 1/2568">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏≠‡∏ö</option>
    </select>
  
    <div id="tableContainer"></div>
  
    <script>
      const URL = "https://script.google.com/macros/s/AKfycbzOY_kwIkpO9yvjDfzf-OKOyFr_FNrVi5YAxlBTPFax1Mybv0b_1Ew00qYvZZUcXEyI/exec";
  
      document.getElementById("typeSelect").addEventListener("change", renderTable);
  
      let allData = null;
  
      async function fetchData() {
        const res = await fetch(URL);
        const json = await res.json();
        allData = json;
        renderTable();
      }
  
      function renderTable() {
        if (!allData) return;
  
        const type = document.getElementById("typeSelect").value;
        const rows = allData[type] || [];
  
        // ‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤
        rows.sort((a, b) => {
          const dateA = parseThaiDate(a["‡∏ß‡∏±‡∏ô-‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô"] || a["‡∏ß‡∏±‡∏ô-‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏≠‡∏ö"]);
          const dateB = parseThaiDate(b["‡∏ß‡∏±‡∏ô-‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô"] || b["‡∏ß‡∏±‡∏ô-‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏≠‡∏ö"]);
          return dateA - dateB;
        });
  
        const container = document.getElementById("tableContainer");
        if (rows.length === 0) {
          container.innerHTML = "<p>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>";
          return;
        }
  
        // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
        const headers = Object.keys(rows[0]);
        let html = "<table><thead><tr>";
        headers.forEach(h => html += `<th>${h}</th>`);
        html += "</tr></thead><tbody>";
  
        rows.forEach(row => {
          html += "<tr>";
          headers.forEach(h => html += `<td>${row[h] ?? ""}</td>`);
          html += "</tr>";
        });
  
        html += "</tbody></table>";
        container.innerHTML = html;
      }
  
      function parseThaiDate(str) {
        if (!str || typeof str !== "string" || str.includes("‡∏ô‡∏≠‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á")) {
          return new Date(9999, 0, 1);
        }
      
        try {
          const months = {
            "‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°": 0, "‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå": 1, "‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°": 2, "‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô": 3,
            "‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°": 4, "‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô": 5, "‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°": 6, "‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°": 7,
            "‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô": 8, "‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°": 9, "‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô": 10, "‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°": 11
          };
      
          const parts = str.trim().split(" ");
          const day = parseInt(parts[1]);
          const rawMonth = parts[2].replace(/[^‡∏Å-‡πô]/g, "");
          const month = months[rawMonth];
          const year = parseInt(parts[3]) - 543;
      
          const [hour, minute] = parts[4].split(":").map(Number);
      
          if (isNaN(day) || isNaN(month) || isNaN(year) || isNaN(hour)) {
            return new Date(9999, 0, 1);
          }
      
          return new Date(year, month, day, hour, minute);
        } catch (e) {
          return new Date(9999, 0, 1);
        }
      }
  
      fetchData();
    </script>
</body>
</html>
